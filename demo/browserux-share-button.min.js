!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).BrowseruxShareButton={})}(this,function(e){"use strict";function n(e){const n=Array.from(document.querySelectorAll("link[rel]")),t=n.find(e=>e.rel.includes("icon")&&"image/svg+xml"===e.type&&e.href);if(t)return t.href;const r=n.find(e=>"apple-touch-icon"===e.rel&&e.href);if(r)return r.href;const a=n.find(e=>e.rel.includes("icon")&&e.href);return a?a.href:e}const t={x:"https://browserux.com/commons/logos/x.png",facebook:"https://browserux.com/commons/logos/facebook.png",whatsapp:"https://browserux.com/commons/logos/whatsapp.png",email:"https://browserux.com/commons/logos/mail.png",sms:"https://browserux.com/commons/logos/sms.png",copy:"https://browserux.com/commons/logos/copy.png",website:"https://browserux.com/commons/logos/website.png",linkedin:"https://browserux.com/commons/logos/linkedin.png",telegram:"https://browserux.com/commons/logos/telegram.png",reddit:"https://browserux.com/commons/logos/reddit.png"};function r(e){return t[e]||""}const a=document.createElement("template");a.innerHTML='\n<style>\n  :host,\n  :root {\n    --bux-share-btn-bg: #eaeaea;\n    --bux-share-btn-color: #121212;\n    --bux-share-btn-font-size: 2rem;\n    --bux-share-btn-height: 4.2rem;\n    --bux-share-btn-padding-inline: 1.5rem;\n    --bux-share-btn-border-radius: 0.5rem;\n    --bux-share-btn-gap: 0.5rem;\n    --bux-share-btn-hover-bg: #121212;\n    --bux-share-btn-hover-color: #eaeaea;\n  }\n\n  #bux-share-btn {\n    align-items: center;\n    appearance: none; \n    font-family: inherit;\n    background: var(--bux-share-btn-bg);\n    border: none; \n    border-radius: var(--bux-share-btn-border-radius);\n    color: var(--bux-share-btn-color);\n    cursor: pointer;\n    display: inline-flex;\n    font-size: var(--bux-share-btn-font-size);\n    font-weight: bold;\n    gap: var(--bux-share-btn-gap);\n    height: var(--bux-share-btn-height);\n    justify-content: center;\n    line-height: 1;\n    padding-inline: var(--bux-share-btn-padding-inline);\n    user-select: none; \n    vertical-align: middle;\n  }\n\n  #bux-share-btn:hover {\n    background: var(--bux-share-btn-hover-bg);\n    color: var(--bux-share-btn-hover-color);\n  }\n\n  ::slotted(*) {\n    line-height: 1;\n    vertical-align: middle;\n  }\n\n  ::slotted(svg),\n  ::slotted(img),\n  ::slotted(span) {\n    display: block;\n  }\n</style>\n\n\x3c!-- Main share button, with optional slot for icon and dynamic label --\x3e\n<button id="bux-share-btn">\n  <slot name="icon">🔗</slot>\n  <span id="label-placeholder">Share</span>\n</button>\n';const o=document.createElement("template");o.innerHTML='\n\n<div class="bux-share-fallback">\n  <div id="bux-share-fallback-menu">\n    <div class="bux-share-fallback-inner" role="dialog" aria-labelledby="bux-share-fallback-title" tabindex="0">\n      <h2 id="bux-share-fallback-title"></h2>\n      <div id="bux-copy-box">\n        <button style="width: 100%;" id="bux-copy-link"></button>\n      </div>\n      <ul id="bux-platforms-list"></ul>\n    </div>\n  </div>\n</div>\n';const i={en:{share:"Share",email:"Email",sms:"Messages",copied:"Link copied!",errorInit:"Error initializing share button:",errorShare:"Error during native sharing:",errorCopy:"Error copying link:"},fr:{share:"Partager",email:"Email",sms:"Messages",copied:"Lien copié !",errorInit:"Erreur d'initialisation du bouton de partage :",errorShare:"Erreur lors du partage natif :",errorCopy:"Erreur lors de la copie du lien :"},es:{share:"Compartir",email:"Correo",sms:"Mensajes",copied:"¡Enlace copiado!",errorInit:"Error al inicializar el botón de compartir:",errorShare:"Error al compartir de forma nativa:",errorCopy:"Error al copiar el enlace:"},de:{share:"Teilen",email:"E-Mail",sms:"Nachrichten",copied:"Link kopiert!",errorInit:"Fehler beim Initialisieren des Teilen-Buttons:",errorShare:"Fehler beim nativen Teilen:",errorCopy:"Fehler beim Kopieren des Links:"},ja:{share:"共有する",email:"メール",sms:"メッセージ",copied:"リンクがコピーされました！",errorInit:"共有ボタンの初期化中にエラーが発生しました：",errorShare:"ネイティブ共有中にエラーが発生しました：",errorCopy:"リンクのコピー中にエラーが発生しました："},ru:{share:"Поделиться",email:"Эл. почта",sms:"Сообщения",copied:"Ссылка скопирована!",errorInit:"Ошибка инициализации кнопки общего доступа:",errorShare:"Ошибка при нативном общем доступе:",errorCopy:"Ошибка копирования ссылки:"},pt:{share:"Compartilhar",email:"Email",sms:"Mensagens",copied:"Link copiado!",errorInit:"Erro ao inicializar o botão de compartilhamento:",errorShare:"Erro ao compartilhar nativamente:",errorCopy:"Erro ao copiar o link:"},it:{share:"Condividi",email:"Email",sms:"Messaggi",copied:"Link copiato!",errorInit:"Errore durante l'inizializzazione del pulsante di condivisione:",errorShare:"Errore durante la condivisione nativa:",errorCopy:"Errore durante la copia del link:"},nl:{share:"Delen",email:"E-mail",sms:"Berichten",copied:"Link gekopieerd!",errorInit:"Fout bij het initialiseren van de deelknop:",errorShare:"Fout bij native delen:",errorCopy:"Fout bij het kopiëren van de link:"}};class s extends HTMLElement{constructor(){super(),this.onKeyDown=e=>{"Escape"===e.key&&this.externalFallbackEl?.classList.contains("visible")&&(this.externalFallbackEl.classList.remove("visible"),this.focusTrapRemover&&this.focusTrapRemover())}}isDisabled(e){return"false"===this.getAttribute(e)}getShareConfig(e){const{shareTitle:n,shareText:t,shareUrl:a,labels:o}=this;switch(e){case"email":return{href:`mailto:?subject=${encodeURIComponent(n)}&body=${encodeURIComponent(t+"\n"+a)}`,label:o.email,icon:r("email")};case"sms":return{href:`sms:?body=${encodeURIComponent(t+" "+a)}`,label:o.sms,icon:r("sms")};case"x":return{href:`https://x.com/intent/tweet?text=${encodeURIComponent(t+" "+a)}`,label:"X",icon:r("x")};case"facebook":return{href:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(a)}`,label:"Facebook",icon:r("facebook")};case"whatsapp":return{href:`https://api.whatsapp.com/send?text=${encodeURIComponent(t+" - "+a)}`,label:"WhatsApp",icon:r("whatsapp")};case"linkedin":return{href:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(a)}`,label:"LinkedIn",icon:r("linkedin")};case"telegram":return{href:`https://t.me/share/url?url=${encodeURIComponent(a)}&text=${encodeURIComponent(t)}`,label:"Telegram",icon:r("telegram")};case"reddit":return{href:`https://www.reddit.com/submit?url=${encodeURIComponent(a)}&title=${encodeURIComponent(n)}`,label:"Reddit",icon:r("reddit")};default:return null}}render(){this.root.innerHTML="",this.root.appendChild(a.content.cloneNode(!0));const e=this.labels,n=this.root.querySelector("#label-placeholder");n&&(n.textContent=e.share);this.root.querySelector("#bux-share-btn").addEventListener("click",async()=>{const e={title:this.shareTitle,text:this.shareText,url:this.shareUrl};if("share"in navigator){if(navigator.canShare&&!navigator.canShare(e))return void this.showFallback();try{await navigator.share(e)}catch(e){console.error(this.labels.errorShare,e),this.showFallback()}}else this.showFallback()})}renderExternalFallback(){if(this.externalFallbackEl)return;const e=o.content.firstElementChild?.cloneNode(!0);if(!e)return;const t=e.querySelector("#bux-share-fallback-title");if(t&&(t.textContent=this.labels.share),!document.head.querySelector("[data-bux-fallback-style]")){const e=document.createElement("style");e.textContent="\n:root {\n  --bux-share-fallback-bg: #251f17;\n  --bux-share-fallback-color: #ede0d4;\n  --bux-share-fallback-border-radius: 2rem;\n  --bux-share-fallback-title-font-size: 2.2rem;\n  --bux-share-fallback-copy-box-bg: #302921;\n}\n\n#bux-share-fallback-menu {\n  /* Ne pas forcer display ni largeur ici */\n  text-align: left;\n  background: transparent;\n}\n\n.bux-share-fallback {\n  position: fixed;\n  inset: 0;\n  display: flex;\n  align-items: center;      \n  justify-content: center;   \n  opacity: 0;\n  pointer-events: none;\n  transition: opacity 0.2s ease-in-out;\n  z-index: 9999;\n  background: rgba(0, 0, 0, 0.3); /* Optionnel : léger fond pour modale */\n}\n\n.bux-share-fallback.visible {\n  opacity: 1;\n  pointer-events: auto;\n}\n.bux-share-fallback-inner {\n  background: var(--bux-share-fallback-bg);\n  border-radius: var(--bux-share-fallback-border-radius);\n  color: var(--bux-share-fallback-color);\n  max-width: 320px;\n  width: auto;\n  padding: 20px;\n  box-sizing: border-box;\n  transition: transform 0.2s ease-out, opacity 0.2s ease-out;\n}\n\n@media (max-width: 768px) {\n  #bux-share-fallback-menu {\n    width: 100%;\n  }\n  .bux-share-fallback {\n    align-items: end;  \n  }\n  .bux-share-fallback-inner {\n    width: 100%;\n    max-width: 100%;\n    border-radius: var(--bux-share-fallback-border-radius) var(--bux-share-fallback-border-radius) 0 0;\n    transform: translateY(100%);\n  }\n  .bux-share-fallback.visible .bux-share-fallback-inner {\n    transform: translateY(0); /* 👈 remonte */\n  }\n}\n\n#bux-share-fallback-title {\n  color: inherit;\n  font-size: var(--bux-share-fallback-title-font-size);\n  font-weight: normal;\n  margin: 0;\n}\n\n#bux-share-fallback-menu a,\n#bux-share-fallback-menu button {\n  appearance: none; \n  background: none;\n  border: none; \n  color: inherit;\n  cursor: pointer;\n  font-family: inherit;\n  text-align: left;\n  text-decoration: none;\n}\n\n#bux-copy-box {\n  background: var(--bux-share-fallback-copy-box-bg);\n  padding: 10px;\n  border-radius: var(--bux-share-fallback-border-radius);\n  margin: 20px 0;\n}\n\n#bux-copy-wrapper {\n  align-items: center;\n  display: flex;\n  gap: 10px;\n  overflow: hidden;\n  width: 100%;\n}\n\n#bux-copy-logo {\n  flex: 0 0 auto;\n  width: 48px;\n}\n\n#bux-copy-text {\n  flex: 1 1 auto;\n  overflow: hidden;\n  min-width: 0;\n}\n\n#bux-copy-text strong {\n  display: block;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n#bux-copy-icon {\n  flex: 0 0 auto;\n  font-size: 2.5rem;\n}\n\n#bux-share-fallback-menu ul {\n  align-items: center;\n  display: flex;\n  flex-wrap: wrap;\n}\n\n#bux-share-fallback-menu ul li {\n  font-size: 14px;\n  margin: 5px 0;\n  min-width: 70px;\n  text-align: center;\n  width: 70px;\n}\n\n#bux-share-fallback-menu ul a img {\n  border-radius: 50%;\n  width: 50px;\n}\n\n#bux-share-fallback-menu ul a span {\n  display: block;\n  text-align: center;\n}\n",e.setAttribute("data-bux-fallback-style","true"),document.head.appendChild(e)}document.body.appendChild(e),this.externalFallbackEl=e,this.bindFallbackEvents(e),this.renderPlatformLinks(e);const a=`\n      <span id="bux-copy-wrapper">\n        <span id="bux-copy-logo">\n          <img src="${n(r("website"))}" alt="App icon" width="48" height="48">\n        </span>\n        <span id="bux-copy-text">\n          <strong>${this.shareTitle}</strong>\n          ${this.shareUrl}\n        </span>\n        <span id="bux-copy-icon">\n          🔗\n        </span>\n      </span>\n    `;this.renderCopyButton(e,a)}renderPlatformLinks(e){const n=e.querySelector("#bux-platforms-list"),t=/Mobi|Android/i.test(navigator.userAgent);["email","x","facebook","whatsapp","sms","linkedin","telegram","reddit"].forEach(e=>{if(this.isDisabled(e))return;if("sms"===e&&!t)return;const r=document.createElement("li"),a=document.createElement("a");a.target="_blank";const o=this.getShareConfig(e);o&&(a.href=o.href,a.innerHTML=`<img src="${o.icon}" alt="${o.label}" width="48" height="48"><span>${o.label}</span>`,r.appendChild(a),n.appendChild(r))})}renderCopyButton(e,n){const t=e.querySelector("#bux-copy-link"),r=this.labels;t.innerHTML=n,t.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(this.shareUrl),t.textContent=r.copied,setTimeout(()=>t.innerHTML=n,2e3)}catch(e){console.error(r.errorCopy,e)}})}bindFallbackEvents(e){if(e.addEventListener("click",n=>{const t=e.querySelector(".bux-share-fallback-inner");t&&(t.contains(n.target)||(e.classList.remove("visible"),document.removeEventListener("keydown",this.onKeyDown),this.focusTrapRemover&&this.focusTrapRemover()))}),window.innerWidth<=768){let n=null;const t=e.querySelector(".bux-share-fallback-inner");if(!t)return;t.addEventListener("touchstart",e=>{n=e.touches[0].clientY}),t.addEventListener("touchmove",t=>{if(null===n)return;t.touches[0].clientY-n>60&&(e.classList.remove("visible"),document.removeEventListener("keydown",this.onKeyDown),this.focusTrapRemover&&this.focusTrapRemover(),n=null)}),t.addEventListener("touchend",()=>{n=null})}}showFallback(){this.renderExternalFallback(),this.externalFallbackEl&&(this.externalFallbackEl.offsetHeight,requestAnimationFrame(()=>{setTimeout(()=>{this.externalFallbackEl.classList.add("visible");const e=this.externalFallbackEl.querySelector(".bux-share-fallback-inner");e&&"function"==typeof e.focus&&e.focus();const n=e.querySelectorAll('a[href], button:not([disabled]), [tabindex]:not([tabindex="-1"])'),t=n[0],r=n[n.length-1],a=e=>{"Tab"===e.key&&0!==n.length&&(e.shiftKey?document.activeElement===t&&(e.preventDefault(),r.focus()):document.activeElement===r&&(e.preventDefault(),t.focus()))};document.addEventListener("keydown",a),this.focusTrapRemover=()=>document.removeEventListener("keydown",a),document.addEventListener("keydown",this.onKeyDown)},20)}))}async connectedCallback(){this.root=this.hasAttribute("no-shadow")?this:this.attachShadow({mode:"open"});const e=this.getAttribute("lang")||document.documentElement.lang||"en",n=i[e]?e:"en";this.labels=i[n];let t={};const r=this.hasAttribute("title"),a=this.hasAttribute("text");if(!r||!a)try{const e=this.getAttribute("manifest-src"),n=document.querySelector('link[rel="manifest"]'),r=e||n?.href;if(r){const e=await fetch(r);if(!e.ok)throw new Error(`HTTP error ${e.status}`);t=await e.json()}}catch(e){console.warn(this.labels.errorInit,e)}this.shareTitle=this.getAttribute("title")||document.title?.trim()||null||t.name||"Untitled";const o=document.querySelector('meta[name="description"]');this.shareText=this.getAttribute("text")||o?.content?.trim()||t.description||"",this.shareUrl=this.getAttribute("url")||location.href,this.render(),this.applyInlineCSSVars()}applyInlineCSSVars(){const e=this.root instanceof ShadowRoot?this.root.host:this.root;if(e instanceof HTMLElement)for(let n=0;n<this.style.length;n++){const t=this.style.item(n);if(t.startsWith("--")){const n=this.style.getPropertyValue(t);n&&e.style.setProperty(t,n)}}}}customElements.define("browserux-share-button",s);var l=Object.freeze({__proto__:null,ShareButton:s});e.ShareButton=s,e.defineBrowseruxComponents=function(){customElements.get("browserux-share-button")||Promise.resolve().then(function(){return l})},e.getBestIconUrl=n,e.getShareIcon=r});
